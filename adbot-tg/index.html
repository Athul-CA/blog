<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:var(--textLink);text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}p code{font-size:1rem;}</style><meta data-react-helmet="true" property="og:image" content="https://hqasco.deta.dev/img?url=https://blog.athulcyriac.xyz/adbot-tg/"/><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#1abaa2"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=519bd8bebf1fb294001f74588a720ed9"/><title data-react-helmet="true">Telegram Bot with Adguard | dayDreams ++</title><meta data-react-helmet="true" name="description" content="A Telegram Bot for receiving Adguard Home statistics"/><meta data-react-helmet="true" property="og:title" content="Telegram Bot with Adguard"/><meta data-react-helmet="true" property="og:description" content="A Telegram Bot for receiving Adguard Home statistics"/><meta data-react-helmet="true" property="og:type" content="website"/><meta name="generator" content="Gatsby 2.20.35"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Athul Cyriac Ajay"/><meta data-react-helmet="true" name="twitter:title" content="Telegram Bot with Adguard"/><meta data-react-helmet="true" name="twitter:description" content="A Telegram Bot for receiving Adguard Home statistics"/><meta data-react-helmet="true" name="twitter:image" content="https://hqasco.deta.dev/img?url=https://blog.athulcyriac.xyz/adbot-tg/"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="theme-color" content="#f0da4f"/><style data-href="/blog/styles.b2b2f2e271d92f9b3a35.css">@import url(https://cdn.jsdelivr.net/npm/@xz/fonts@1/serve/fira-sans.min.css);@import url(https://cdn.jsdelivr.net/npm/@xz/fonts@1/serve/cascadia-code.min.css);@import url(https://fonts.googleapis.com/css2?family=Open+Sans:wght@700&display=swap);@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/blog/static/montserrat-latin-100-4124805c0503dbfe42dd67d7f5715964.woff2) format("woff2"),url(/blog/static/montserrat-latin-100-c8fb2f714bbc7bc3e8dfffa916b286dc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/blog/static/montserrat-latin-100italic-e4bf47bd171a9b2a72dd84c58bf90edf.woff2) format("woff2"),url(/blog/static/montserrat-latin-100italic-d1f3f2d02ee4d7d2d4b1ad865014f189.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/blog/static/montserrat-latin-200-444ae007121264bc1969d49b4031f9b2.woff2) format("woff2"),url(/blog/static/montserrat-latin-200-edbce16a90aa22c297a0307b85789837.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/blog/static/montserrat-latin-200italic-f316c5d1ec40f3e68654c3f38b3999f3.woff2) format("woff2"),url(/blog/static/montserrat-latin-200italic-d7bbb730d9b5e11720b3eb32326dcca7.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/blog/static/montserrat-latin-300-0a7c6df06e85d978d096d4d18fd8d43d.woff2) format("woff2"),url(/blog/static/montserrat-latin-300-5e86df2cad22d2ef2b03516334afae5e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/blog/static/montserrat-latin-300italic-c076c4892bc7a4be7b9097e97a35012d.woff2) format("woff2"),url(/blog/static/montserrat-latin-300italic-37c74a8d2d0d36a0a2c6e9a37ee15b0c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/blog/static/montserrat-latin-400-501ce09c42716a2f6e1503a25eb174c9.woff2) format("woff2"),url(/blog/static/montserrat-latin-400-f29d2b8559699b6beb5b29b25b8bc572.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/blog/static/montserrat-latin-400italic-882908d9950d9c86ebd380877f293d95.woff2) format("woff2"),url(/blog/static/montserrat-latin-400italic-22e7b04e5f2a901d49d4d342315a715a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/blog/static/montserrat-latin-500-f0f2716c5fe401d175b88715e7d28685.woff2) format("woff2"),url(/blog/static/montserrat-latin-500-991b453bf90a0980e78966d2af7e3d3a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/blog/static/montserrat-latin-500italic-4590ebba421b3288c305305d7fa7b504.woff2) format("woff2"),url(/blog/static/montserrat-latin-500italic-f3d41e4cdcc2314e49ddcea751d6f87f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/blog/static/montserrat-latin-600-15c24f7109941777774ddd2c636c6a50.woff2) format("woff2"),url(/blog/static/montserrat-latin-600-f6dc6096f48956908c1787d9a722570a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/blog/static/montserrat-latin-600italic-6d10b80529d5c36c7c09fca7193af0fc.woff2) format("woff2"),url(/blog/static/montserrat-latin-600italic-02c4833312d94b1b0866f073023a250e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/blog/static/montserrat-latin-700-79982cd1f74c6fa7451bf9b37ead09ff.woff2) format("woff2"),url(/blog/static/montserrat-latin-700-957e93fbbe131a59791cd820d98b7109.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/blog/static/montserrat-latin-700italic-283438e9577fe6a684466bb100e105ec.woff2) format("woff2"),url(/blog/static/montserrat-latin-700italic-ca627c5ccc65cf80c2ecaea44b997de9.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/blog/static/montserrat-latin-800-35386154b78d046218fc8f88a44ff515.woff2) format("woff2"),url(/blog/static/montserrat-latin-800-756655905d91b77960888262e7d58d35.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/blog/static/montserrat-latin-800italic-e1b52a7bd83e2324db6d92bdc206844c.woff2) format("woff2"),url(/blog/static/montserrat-latin-800italic-a69f0add9d86c1a84311d7dd8693ba4a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/blog/static/montserrat-latin-900-260c2ea3ef57feb82251952e605a36d5.woff2) format("woff2"),url(/blog/static/montserrat-latin-900-186cae8091da578150d81958e217714a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/blog/static/montserrat-latin-900italic-d785fb9fc74588ffb7f306799709a97d.woff2) format("woff2"),url(/blog/static/montserrat-latin-900italic-43b527fe77254f97ea36e2b54e845ec4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/blog/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/blog/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/blog/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/blog/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/blog/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/blog/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/blog/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/blog/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/blog/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/blog/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/blog/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/blog/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/blog/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/blog/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/blog/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/blog/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}body.dark{--bg:#121116;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#ff0;--textLink:#ff0;--block:hsla(0,0%,100%,0.63);--hr:hsla(0,0%,100%,0.2);--link:#121116;--date:silver;--ttr:teal;--hovercolor:#50fa7b;--headingcol:#50fa7b;background-color:var(--bg);--callout:#42b983;--calbdcol:#50fa7b;--selection:#dc143c;--gh:#1e90ff;--gh-bx:#000;--inlineCode-text:#addb67}body,body.dark{transition:background .2s ease-out}body{--bg:#fff;--textNormal:#000;--textTitle:#dc143c;--block:#928a8a;--textLink:#1e90ff;--hr:rgba(0,0,0,0.2);--link:#fff;--date:#2f4f4f;--ttr:#1e90ff;--hovercolor:navy;--headingcol:#dc143c;--callout:#0ff;--calbdcol:red;--selection:navy;--gh:#00f;--gh-bx:azure;--inlineCode-text:#e6e6e6}.theme-switch-wrapper{display:flex;align-items:center}.theme-switch{display:inline-block;height:34px;position:relative;width:60px}.theme-switch input{display:none}.slider{background-color:#000;bottom:0;cursor:pointer;left:0;right:0;top:0}.slider,.slider:before{position:absolute;transition:.4s}.slider:before{background-color:#fff;bottom:4px;content:"";height:26px;left:4px;width:26px}input:checked+.slider{background-color:#40e0d0}input:checked+.slider:before{transform:translateX(26px)}.slider.round{border-radius:34px}.slider.round:before{border-radius:50%}::selection{color:#fff;background-color:var(--selection)}.content,.desc{font-family:Fira Sans,sans-serif;font-size:large}.content a:hover{color:var(--link);background-color:var(--hovercolor)}blockquote{border-color:#639;color:var(--textNormal)}hr{border-top:3px solid #639}.gatsby-highlight{font-size:smaller;position:relative}.gatsby-highlight pre[class*=language-]{-webkit-overflow-scrolling:touch}.gatsby-highlight pre[class*=language-]:before{background:#000;border-radius:0 0 .25rem .25rem;color:#fff;font-size:12px;letter-spacing:.025rem;padding:.1rem .5rem;position:absolute;right:1rem;text-align:right;text-transform:uppercase;top:0}.gatsby-highlight pre[class=language-js]:before{content:"js";background:#f7df1e;color:#000}.gatsby-highlight pre[class*=language-yaml]:before,.gatsby-highlight pre[class*=language-yml]:before{content:"yaml";background:#f71e6a;color:#fff}.gatsby-highlight pre[class*=language-bash]:before,.gatsby-highlight pre[class*=language-sh]:before,.gatsby-highlight pre[class*=language-shell]:before{content:"shell";background:green;color:#fff}.gatsby-highlight pre[class*=language-json]:before{content:"json";background:#eee8aa;color:#000}.gatsby-highlight pre[class*=language-py]:before,.gatsby-highlight pre[class*=language-python]:before{content:"py";background:#00f;color:#ff0}.gatsby-highlight pre[class*=language-jsx]:before{content:"jsx";background:#f0f;color:#fff}.gatsby-highlight pre[class*=language-html]:before{content:"html";background:#ff4500;color:#fff}.gatsby-highlight pre[class*=language-css]:before{content:"css";background:#0ff;color:#000}.gatsby-highlight pre[class*=language-go]:before{content:"Go";background:#0ff;color:#4169e1}.gatsby-highlight pre[class*=language-md]:before{content:"md / MDX";background:#4169e1;color:#f5f5f5}.gatsby-highlight pre[class*=language-diff]:before{content:"DIFF";background:#32cd32;color:red}.bio{font-family:Fira Sans,sans-serif;font-size:medium}img{display:block;margin:0 auto}h2,h3,h4,h5{letter-spacing:-.015em;font-family:Open Sans,sans-serif;font-size:x-large}.callout{color:#000;background:azure;padding:1.5em 1.25em;border-radius:25px;display:flex;flex-direction:row;margin-top:20px;border-bottom:4px solid var(--calbdcol);border-left:6px solid var(--calbdcol)}.callout-inner{font-style:italic;margin-left:1em}.callout a{color:#00f}.callout a:hover{background:#adff2f}@media (max-width:767px){.callout{padding:1.5em .75em 1.5em .6em}.callout-inner{margin-left:.5em}}div .callout:before{color:red;content:attr(emoji)}.new-label{color:#50fa7b;text-decoration:none;padding:2px 4px;border-radius:4px;margin-left:6px;background-color:#1e90ff}code[class*=language-],pre[class*=language-]{color:#fff;background:none;font-family:Cascadia Code,monospace;font-feature-settings:normal;font-size:medium;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:hsla(0,0%,100%,.15)}:not(pre)>code[class*=language-]{border-radius:.3em;background:#031627;color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;display:block;padding-right:1em;padding-left:1.25em;border-left:.25em solid #ffa7c4}.gatsby-highlight,.gatsby-highlight-code-line{margin-right:-1.3125rem;margin-left:-1.3125rem}.gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}</style><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-625262e63a34479f5aba.js"/><link as="script" rel="preload" href="/blog/cd7d5f864fc9e15ed8adef086269b0aeff617554-5e7f08b6e436d8b59f85.js"/><link as="script" rel="preload" href="/blog/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-a13ac807210b3e33c66b.js"/><link as="script" rel="preload" href="/blog/styles-6b8affa5cc22cb60670e.js"/><link as="script" rel="preload" href="/blog/app-ae5db0200c12acc83fbc.js"/><link as="script" rel="preload" href="/blog/framework-972833c791692296cdd7.js"/><link as="script" rel="preload" href="/blog/webpack-runtime-d29b2035ec05bd8f2fab.js"/><link as="fetch" rel="preload" href="/blog/page-data/adbot-tg/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="background-color:var(--bg);color:var(--textNormal);transition:color 0.2s ease-out, background 0.2s ease-out;margin-left:auto;margin-right:auto;max-width:61.25rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:tomato" href="/blog/">dayDreams ++</a></h3></header><main><h1 align="center" style="color:lightseagreen">Telegram Bot with Adguard</h1><p align="center" style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem">October 10, 2020<br/></p><div class="content"><p>Recently I had this idea of setting up a network-level adblocker in my Home. But sadly I don’t use a fibre/broadband connection 🤷‍♂️ so I thought of setting up one on my laptop. The initial choice was PiHole(obviously) but due to the extremities of setting it up on Mac, I jumped ship to <a href="https://github.com/AdguardTeam/AdguardHome">Adguard Home</a> on getting some feedback from friends. It also piqued my interest when I saw Adguard Home was written in Go and the frontend in React rather than the PHP frontend of PiHole. It was easy to set up and running and they give the instructions quite well.</p><blockquote><p>I use Brave as my daily driver, It blocks almost all the ads(even Spotify ads on the web player)</p></blockquote><h2>AdBot</h2><p>No, It’s not a bot that sends you ads(😝). It’s a one-way bot(as of now) which means I can only receive messages like the statistics of the ads blocked overtime via adguard. I wrote the bot in Go to achieve independency of installing packages and making it run on a Raspberry Pi with a single binary.  This binary can be hooked up with a CronJob to send the data over a specified time. So, if I’m not home, I can get the statistics of the number of users on my network and related stuff. If you’re unaware of creating a Telegram Bot and getting a chat id, refer <a href="https://core.telegram.org/bots#6-botfather">Telegram Bot Documnetation</a></p><p>I hooked it up a graph generator to send me an Ascii line graph and a Pie Chart image with the most blocked domains. The whole thing was hacked in 2 hours. It was a fun build. I’ll explain the code piece by piece.</p><h2>The Code</h2><p>As I told you the code is in Go. For starters, I used my favourite HTTP client <a href="https://insomnia.rest/">Insomnia</a> to check the API endpoints on the Adguard Home’s Server. Funnily enough, the only required header for such a request is an <code class="language-text">agh_session</code> token. This is fixed for a server and you only need to get it once from the server and use it indefinitely for the bot. They also have a “not-so-much” working <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> header auth. It’ll work with a single token the whole time. I used Insomnia’s code-generator to bootstrap the bot for receiving the JSON Payload. The only things you’ll need will be the Adguard Home installed and the <code class="language-text">agh_session</code> token. Here is a gif of how you could get one</p><p><img src="https://file.coffee/u/nuAQBNHR_M.gif" alt="AGH_Session-GIF"/></p><h3>HTTP request</h3><p>Here is the generated code from insomnia.</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	req<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://127.0.0.1/control/stats&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;cookie&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;agh_session=&lt;some sha string&gt;&quot;</span><span class="token punctuation">)</span>

	res<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> res<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    body<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><p>The next step was to unmarshal the JSON to be used in Go.</p><h3>JSON → Go</h3><p>The JSON payload received was long since it had the data regarding the blocked domains too. I used a <a href="https://mholt.github.io/json-to-go/">Json to Struct</a> to convert the JSON to its valid struct types. But some JSON arrays were hard for it to comprehend so it made each struct key for each key, which was not the expected one. So I used <a href="https://gobyexample.com/maps">Go Maps</a> to make it workable. This is the struct type of the JSON payload</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token comment">// Stats represents the data from Adguard as JSON</span>
<span class="token keyword">type</span> Stats <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ProcessingTime    <span class="token builtin">float64</span>              <span class="token string">`json:&quot;avg_processing_time&quot;`</span>
	BlockedFilter     <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;blocked_filtering&quot;`</span>
	DNSQueries        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;dns_queries&quot;`</span>
	BlockedFilterNum  <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_blocked_filtering&quot;`</span>
	DNSQueriesNum     <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_dns_queries&quot;`</span>
	PT                <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_parental&quot;`</span>
	NumSB             <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_safebrowsing&quot;`</span>
	NumSS             <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_safesearch&quot;`</span>
	ReplacedPT        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;replaced_parental&quot;`</span>
	ReplacedSB        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;replaced_safebrowsing&quot;`</span>
	TimeUnits         <span class="token builtin">string</span>               <span class="token string">`json:&quot;time_units&quot;`</span>
	TopBlockedDomains <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_blocked_domains&quot;`</span>
	TopClients        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_clients&quot;`</span>
	TopQueriedDomains <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_queried_domains&quot;`</span>
<span class="token punctuation">}</span></code></pre></div><p>So this struct unmarshals the Json to Go readable types. This makes it easier to handle the data wrangling in Go. Here is the code which parses the JSON and uses it.</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Stats represents the data from Adguard as JSON</span>
<span class="token keyword">type</span> Stats <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ProcessingTime    <span class="token builtin">float64</span>              <span class="token string">`json:&quot;avg_processing_time&quot;`</span>
	BlockedFilter     <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;blocked_filtering&quot;`</span>
	DNSQueries        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;dns_queries&quot;`</span>
	BlockedFilterNum  <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_blocked_filtering&quot;`</span>
	DNSQueriesNum     <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_dns_queries&quot;`</span>
	PT                <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_parental&quot;`</span>
	NumSB             <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_safebrowsing&quot;`</span>
	NumSS             <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_safesearch&quot;`</span>
	ReplacedPT        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;replaced_parental&quot;`</span>
	ReplacedSB        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;replaced_safebrowsing&quot;`</span>
	TimeUnits         <span class="token builtin">string</span>               <span class="token string">`json:&quot;time_units&quot;`</span>
	TopBlockedDomains <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_blocked_domains&quot;`</span>
	TopClients        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_clients&quot;`</span>
	TopQueriedDomains <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_queried_domains&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	req<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://127.0.0.1/control/stats&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;cookie&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;agh_session=&lt;some sha string&gt;&quot;</span><span class="token punctuation">)</span>

	res<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> res<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	body<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>

	<span class="token keyword">var</span> stats Stats

	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span></code></pre></div><p>Nothing fancy of any type, just plain Go code. The next is to generate the Ascii graph from the data we got.</p><h3>Ascii 📈</h3><p>There was a <a href="https://github.com/guptarohit/asciigraph">package in Go</a>  which generates Ascii graphs, not to reinvent the wheel, I just hooked it up to work with the data received. I reduced it’s height to enclose it inside a single message. Here are the code and output of the graph</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go">
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Stats<span class="token punctuation">)</span> <span class="token function">generateGraph</span><span class="token punctuation">(</span>tp <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Graph Generated&quot;</span><span class="token punctuation">)</span>
	graphof <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">{</span>
		<span class="token string">&quot;DNS&quot;</span><span class="token punctuation">:</span> s<span class="token punctuation">.</span>DNSQueries<span class="token punctuation">,</span>
		<span class="token string">&quot;BLK&quot;</span><span class="token punctuation">:</span> s<span class="token punctuation">.</span>BlockedFilter<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	caption <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;DNS&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Number of DNS Queries&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;BLK&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Number of Blocked Queries&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	graph <span class="token operator">:=</span> asciigraph<span class="token punctuation">.</span><span class="token function">Plot</span><span class="token punctuation">(</span>graphof<span class="token punctuation">[</span>tp<span class="token punctuation">]</span><span class="token punctuation">,</span> asciigraph<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asciigraph<span class="token punctuation">.</span><span class="token function">Caption</span><span class="token punctuation">(</span>caption<span class="token punctuation">[</span>tp<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> graph
<span class="token punctuation">}</span>
</code></pre></div><p>This is not a function but a method in Go. This depends on the Struct type Stats(specifically the pointer) to work. I also introduced a map to get the data of the specified stuff like no. of DNS queries and the number of blocked queries.  </p><p>Here is a sample output of the Graphs from the data I received both the DNS Queries and Blocked queries</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">
DNS Query Graph :

 888 ┼╭╮
 799 ┤││               ╭╮   ╭
 710 ┤││               ││   │
 622 ┤│╰╮             ╭╯│   │
 533 ┤│ │ ╭╮          │ │   │
 444 ┤│ │ ││          │ │   │
 355 ┤│ │ │╰╮        ╭╯ │   │
 266 ┤│ │ │ │        │  │   │
 178 ┤│ │╭╯ │        │  │   │
  89 ┤│ ╰╯  │        │  │   │
   0 ┼╯     ╰────────╯  ╰───╯

    Number of DNS Queries

-----

Blocked Graph:

 213 ┼                      ╭
 192 ┤                      │
 170 ┤                 ╭╮   │
 149 ┤╭╮   ╭╮          ││   │
 128 ┤││   ││          ││   │
 106 ┤││   ││          ││   │
  85 ┤││  ╭╯│         ╭╯│   │
  64 ┤││  │ │         │ │   │
  43 ┤│╰╮ │ │         │ │   │
  21 ┤│ │ │ │        ╭╯ │   │
   0 ┼╯ ╰─╯ ╰────────╯  ╰───╯

    Number of Blocked Queries
</code></pre></div><p>The graph data is an array of 24 elements which means data for each hour. I don’t use my laptop 24 hours so the 0 lines in some places. We call this method from the main function just as we unmarshal the JSON.</p><h3>Pie  📈</h3><p>The Pie Chart will be the data of the Top Blocked Domains. I used <code class="language-text">github.com/wcharczuk/go-chart</code> as the charting library for the pie graph. Initially, it was a bit hard to work with but got the idea of it after some time tinkering with it. It creates an image, unlike the Ascii Chart which is just string. Here is the code for the generating the Pie Chart image.</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Stats<span class="token punctuation">)</span> <span class="token function">pieGrph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Pie Graph Generated and Image Send&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> chartValues <span class="token punctuation">[</span><span class="token punctuation">]</span>chart<span class="token punctuation">.</span>Value
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>TopBlockedDomains <span class="token punctuation">{</span>
		<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>TopBlockedDomains<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">{</span>
			values <span class="token operator">:=</span> chart<span class="token punctuation">.</span>Value<span class="token punctuation">{</span>Label<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%.f:%s&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">,</span> Value<span class="token punctuation">:</span> v<span class="token punctuation">}</span>
			chartValues <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>chartValues<span class="token punctuation">,</span> values<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	pie <span class="token operator">:=</span> chart<span class="token punctuation">.</span>PieChart<span class="token punctuation">{</span>
		Width<span class="token punctuation">:</span>  <span class="token number">512</span><span class="token punctuation">,</span>
		Height<span class="token punctuation">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
		Values<span class="token punctuation">:</span> chartValues<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	f<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">&quot;output.png&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    pie<span class="token punctuation">.</span><span class="token function">Render</span><span class="token punctuation">(</span>chart<span class="token punctuation">.</span>PNG<span class="token punctuation">,</span> f<span class="token punctuation">)</span></code></pre></div><p>This too is a method. This method creates a 512x512 image and saves it as <code class="language-text">output.png</code>. This image will be sent to us via telegram. We also call this method from the main function just as we unmarshal the JSON.</p><h3>Sending the Message</h3><p>Telegram has an HTTP API which makes it quite easy to send messages via bots. But I used a package in Go which handles the Telegram API quite okay, so I used it. Here is the code for sending the Ascii Graph via telegram,</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Stats<span class="token punctuation">)</span> <span class="token function">sendTGMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Message Sent...&quot;</span><span class="token punctuation">)</span>
	percent <span class="token operator">:=</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>BlockedFilterNum <span class="token operator">/</span> s<span class="token punctuation">.</span>DNSQueriesNum<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
	message <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Total DNS Queries : %.f\n\nDNS Queries Blocked : %.f\n\n-----\n\nPercent of Queries Blocked: %.2f%%\n\n-----\n\nDNS Query Graph :\n\n`%s`\n\n-----\n\nBlocked Graph:\n\n`%s`\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>DNSQueriesNum<span class="token punctuation">,</span> s<span class="token punctuation">.</span>BlockedFilterNum<span class="token punctuation">,</span> percent<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">generateGraph</span><span class="token punctuation">(</span><span class="token string">&quot;DNS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">generateGraph</span><span class="token punctuation">(</span><span class="token string">&quot;BLK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	c <span class="token operator">:=</span> tbot<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;telegram_bot_token&gt;&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">,</span> <span class="token string">&quot;https://api.telegram.org&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;telegram_chat_id&gt;&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> tbot<span class="token punctuation">.</span>OptParseModeMarkdown<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;unable to send message: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    s<span class="token punctuation">.</span><span class="token function">pieGrph</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">SendPhotoFile</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;telegram_chat_id&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;output.png&quot;</span><span class="token punctuation">,</span> tbot<span class="token punctuation">.</span><span class="token function">OptCaption</span><span class="token punctuation">(</span><span class="token string">&quot;PieGraph of Blocked Domains&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;unable to send image: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>This sends a bit more numerical values which are related to Adguard. It just takes in the image in <code class="language-text">output.png</code> and sends it to the chat. Here is the output image. The ugly thing is that there is a lot of data than the pie graph can hold so it renders some of the text quite poorly but I don’t mind that. Here is the output for the above method.</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Total DNS Queries: 5273

DNS Queries Blocked: 927

-----

Per cent of Queries Blocked: 17.58%

-----

DNS Query Graph :

 888 ┼╭╮
 799 ┤││               ╭╮   ╭
 710 ┤││               ││   │
 622 ┤│╰╮             ╭╯│   │
 533 ┤│ │ ╭╮          │ │   │
 444 ┤│ │ ││          │ │   │
 355 ┤│ │ │╰╮        ╭╯ │   │
 266 ┤│ │ │ │        │  │   │
 178 ┤│ │╭╯ │        │  │   │
  89 ┤│ ╰╯  │        │  │   │
   0 ┼╯     ╰────────╯  ╰───╯

    Number of DNS Queries

-----

Blocked Graph:

 213 ┼                      ╭
 192 ┤                      │
 170 ┤                 ╭╮   │
 149 ┤╭╮   ╭╮          ││   │
 128 ┤││   ││          ││   │
 106 ┤││   ││          ││   │
  85 ┤││  ╭╯│         ╭╯│   │
  64 ┤││  │ │         │ │   │
  43 ┤│╰╮ │ │         │ │   │
  21 ┤│ │ │ │        ╭╯ │   │
   0 ┼╯ ╰─╯ ╰────────╯  ╰───╯

    Number of Blocked Queries
</code></pre></div><p><img src="https://file.coffee/u/9ItgsPR2Xu.jpeg" alt="PieGraph"/></p><p>So that’s the whole bot. Here is the full code, I’ll upload it to GitHub later 😁</p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go">
<span class="token comment">// main.go</span>

<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;os&quot;</span>

	<span class="token string">&quot;github.com/guptarohit/asciigraph&quot;</span>
	<span class="token string">&quot;github.com/wcharczuk/go-chart&quot;</span>
	<span class="token string">&quot;github.com/yanzay/tbot&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Stats represents the data from Adguard as JSON</span>
<span class="token keyword">type</span> Stats <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token comment">// Average Processing Time for DNS Queries</span>
	ProcessingTime <span class="token builtin">float64</span> <span class="token string">`json:&quot;avg_processing_time&quot;`</span>
	<span class="token comment">// When the Filters did the Job. The slice consists of 24 elements(24 hours)</span>
	<span class="token comment">// Each item represents the Blockings of Each Hour</span>
	BlockedFilter <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;blocked_filtering&quot;`</span>
	<span class="token comment">// Number of DNSQueries received by Adguard.</span>
	<span class="token comment">//The slice consists of 24 elements(24 hours)</span>
	<span class="token comment">// Each element is the queries received in an hour</span>
	DNSQueries        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;dns_queries&quot;`</span>
	BlockedFilterNum  <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_blocked_filtering&quot;`</span>
	DNSQueriesNum     <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_dns_queries&quot;`</span>
	PT                <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_parental&quot;`</span>
	NumSB             <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_safebrowsing&quot;`</span>
	NumSS             <span class="token builtin">float64</span>              <span class="token string">`json:&quot;num_replaced_safesearch&quot;`</span>
	ReplacedPT        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;replaced_parental&quot;`</span>
	ReplacedSB        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>            <span class="token string">`json:&quot;replaced_safebrowsing&quot;`</span>
	TimeUnits         <span class="token builtin">string</span>               <span class="token string">`json:&quot;time_units&quot;`</span>
	TopBlockedDomains <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_blocked_domains&quot;`</span>
	TopClients        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_clients&quot;`</span>
	TopQueriedDomains <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token string">`json:&quot;top_queried_domains&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	req<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://127.0.0.1/control/stats&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;cookie&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;agh_session=&lt;some sha string&gt;&quot;</span><span class="token punctuation">)</span>

	res<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> res<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	body<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>

	<span class="token keyword">var</span> stats Stats

	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	stats<span class="token punctuation">.</span><span class="token function">sendTGMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	stats<span class="token punctuation">.</span><span class="token function">pieGrph</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Stats<span class="token punctuation">)</span> <span class="token function">generateGraph</span><span class="token punctuation">(</span>tp <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Graph Generated&quot;</span><span class="token punctuation">)</span>
	graphof <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">{</span>
		<span class="token string">&quot;DNS&quot;</span><span class="token punctuation">:</span> s<span class="token punctuation">.</span>DNSQueries<span class="token punctuation">,</span>
		<span class="token string">&quot;BLK&quot;</span><span class="token punctuation">:</span> s<span class="token punctuation">.</span>BlockedFilter<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	caption <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;DNS&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Number of DNS Queries&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;BLK&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Number of Blocked Queries&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	graph <span class="token operator">:=</span> asciigraph<span class="token punctuation">.</span><span class="token function">Plot</span><span class="token punctuation">(</span>graphof<span class="token punctuation">[</span>tp<span class="token punctuation">]</span><span class="token punctuation">,</span> asciigraph<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asciigraph<span class="token punctuation">.</span><span class="token function">Caption</span><span class="token punctuation">(</span>caption<span class="token punctuation">[</span>tp<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> graph
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Stats<span class="token punctuation">)</span> <span class="token function">sendTGMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Message Sent...&quot;</span><span class="token punctuation">)</span>
	percent <span class="token operator">:=</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>BlockedFilterNum <span class="token operator">/</span> s<span class="token punctuation">.</span>DNSQueriesNum<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
	message <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Total DNS Queries : %.f\n\nDNS Queries Blocked : %.f\n\n-----\n\nPercent of Queries Blocked: %.2f%%\n\n-----\n\nDNS Query Graph :\n\n`%s`\n\n-----\n\nBlocked Graph:\n\n`%s`\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>DNSQueriesNum<span class="token punctuation">,</span> s<span class="token punctuation">.</span>BlockedFilterNum<span class="token punctuation">,</span> percent<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">generateGraph</span><span class="token punctuation">(</span><span class="token string">&quot;DNS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">generateGraph</span><span class="token punctuation">(</span><span class="token string">&quot;BLK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	c <span class="token operator">:=</span> tbot<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;telegram_bot_token&gt;&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">,</span> <span class="token string">&quot;https://api.telegram.org&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;telegram_chat_id&gt;&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> tbot<span class="token punctuation">.</span>OptParseModeMarkdown<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;unable to send message: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    s<span class="token punctuation">.</span><span class="token function">pieGrph</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">SendPhotoFile</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;telegram_chat_id&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;output.png&quot;</span><span class="token punctuation">,</span> tbot<span class="token punctuation">.</span><span class="token function">OptCaption</span><span class="token punctuation">(</span><span class="token string">&quot;PieGraph of Blocked Domains&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;unable to send image: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Stats<span class="token punctuation">)</span> <span class="token function">pieGrph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Pie Graph Generated and Image Send&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> chartValues <span class="token punctuation">[</span><span class="token punctuation">]</span>chart<span class="token punctuation">.</span>Value
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>TopBlockedDomains <span class="token punctuation">{</span>
		<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>TopBlockedDomains<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">{</span>
			values <span class="token operator">:=</span> chart<span class="token punctuation">.</span>Value<span class="token punctuation">{</span>Label<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%.f:%s&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">,</span> Value<span class="token punctuation">:</span> v<span class="token punctuation">}</span>
			chartValues <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>chartValues<span class="token punctuation">,</span> values<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	pie <span class="token operator">:=</span> chart<span class="token punctuation">.</span>PieChart<span class="token punctuation">{</span>
		Width<span class="token punctuation">:</span>  <span class="token number">512</span><span class="token punctuation">,</span>
		Height<span class="token punctuation">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
		Values<span class="token punctuation">:</span> chartValues<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	f<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">&quot;output.png&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	pie<span class="token punctuation">.</span><span class="token function">Render</span><span class="token punctuation">(</span>chart<span class="token punctuation">.</span>PNG<span class="token punctuation">,</span> f<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><p>That’s it. Try a <code class="language-text">$ go run main.go</code> to try out the bot. For any queries feel free to create a comment or reach out to me via <a href="https://twitter.com/athulcajay">Twitter</a>.</p><hr/><p>Shameless Plug but you can donate to me on <a href="https://www.buymeacoffee.com/athulca">BMC ☕️</a> or <a href="https://paypal.me/athulca">Paypal</a></p><p align="center">Happy Hacking ⚡️</p></div><div id="inject-comments-for-uterances"></div><hr style="margin-bottom:1.75rem"/><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAFqElEQVQ4yz2Va0yTZxTHX3UbKggiCkWYGBQRtVRARZ2dDuccoigyB+h0jjCHIigirBah7duWUmwpvdEWSu83oFCM6Axh1+wSF7Pbh23ZhyXbPuzbPixbFqE9/72UuZM8OU9Ozvk9/+eS8zA+zW1mwTx9nUygv2sp859NW5XHIybW0dNy4YcReds/4/puhPXdf0yZ2E+nTHLp1KBy29Ncn6Z72YL3a6WLAa9KxLi0oiULc3ffu2VBbedjm+wGGmtPYmvuJuzi83HqSBm9XVPNxarQcr4aVlnb3KRZYb/TeTVtoS6gk8WhzHjIyCgYZsmiSrE4bGLjBRt4vGhqcuo8b11mLD0tgzZu2Iyt+YW0JW9HNC01fS73+SxY5e0YN7C/TRjkJXGFC9Dh05XxbXp13V1T1h4EB6T08t6i+dXJqRxkE+3cUUxF/BIqKBBgS952EvBLsCE7hxhmGfHztz4ZVnXDphD/6e9nC58eAWPeWXws2COCXy+LhQZkMdXNy7hyZC9V7xZQTnYu1q3lYXNmJgqy1yM1OQXpazMoMyOLkhKTUXG0Yk59uxN+Hfv9hIldzoQZ5llLzpbvR5UiBI2K6KRVDaeyg76SN9C91jpcEJagbq8AyuoyvHWoFNlZOcjP24ZMXjYlPLeCXhK+DI1U9uTusAYBfU8XM5TEq3XmbYdP0zU/alaSSdJG75yqoPaKA2h+9QDaak5gsLEWH4vfxOVDJUhKWo2MdTzw0rOQmpJGZQePkEbGxsbMavgNql8YexJvzJvPh1cnnR+19JK6tZFEr1Ug0HQeuroKtFYeRU2pAOIKIWSVQuRlrcdzy5OQuHIVVq5IxOkTVTSgkFHIqIK7n51j3Dcaf/F1XOWAspjPoCBvvwSfdV/Cj4preNBSi0edDXjUVY+H105BdXI/cjPSUZDFw5qkZKStWQsje4v8RhVx6mBXS2KM2yCLekwKji4lt05GYwYWt469gEt7+JAdF8JXfwKzra/jC3EtHPXlaHpxJ4I1Zagv2oqDB/ZjckgLZz8Ln15JFqUY3IOWRN06Ftwgn1FJdnUn5Oeq8NjMQnf2BK4dLIbxjBADdWWoLN4GW+1hfNJ0GlWFWyAXtWLMosWIRgGvvof0sg4wDh37q9ugxEg/BzT1kkV1G/Lqcsy2v43ZW+/A01CJ64dLcKggF9vW8+A59wou7+OjtEiAgKkPTp2KHFolJ6YPms42YkZ0irDP3AeLunveya3S2XyJ6g/uhvi1crx+YA+qdu1Aae7zWJ2YiN05mWgXbsfe/E3olUjgMupg71fRUJ+MPPpesDeb5xinvvesh1vJMzgw/2A8TA6TjXYJiumZZc9gRcIKpCatQmJCQnxUC/LQ/iIfl2vOIODwYcg4QpP+CI06vbGgzcwBr/7GXL9wKMFvNf344fQMHkYeRsfdQVi1erpYW0drU1KwavlyZKaswu6N69EiLEQrdyk6iRQT/nFyWd0UCU3j/uTsk0cfPUbEF1xsNzOR+ycfjN/FpD8cs+vNsTtSFpNuNzWeqaIiXipOFW5GEweTlO2A9Ew5lzdGLouDHBYnwr7Judl7H3BiZn76+tGvK5kRozneHIIOD/teeBqDGl3M3Kedn+CANnUP1ZQUUJuwgNgjfLCV+yloNtODiXs02G+mgCv0ZDp8n4NO/D1ssBbF1YU9AeZO12KT9Q25pC6zDR7LMG61NEdvNLw1rxZ1xC7s49ObRRshutRAbY2NUdHVljmn1YmHd2cQcod+t5vtpQv1kUBksSf6h13MN59/G587jNZyQ6/2O7m4C4NqDazqHpx9aR+uVBwmyc0OdN9og06lhXfER2OeMZ/TNJyxUDfqGl2EBezuuLfpDMy4OxTf/hu1F5cODZirgg4f97y0P0tbr0dvNzdBwyr+sptsXzqsrp5IKCL4/wsY9sZhM1PvM/8CwPAjF+wgjHMAAAAASUVORK5CYII=" alt="Athul Cyriac Ajay" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/blog/static/bd324fda06e94524c5e91425000568d7/8ba1e/profile-pic.png 1x,
/blog/static/bd324fda06e94524c5e91425000568d7/f937a/profile-pic.png 1.5x,
/blog/static/bd324fda06e94524c5e91425000568d7/71eb7/profile-pic.png 2x" /><img loading="lazy" width="50" height="50" srcset="/blog/static/bd324fda06e94524c5e91425000568d7/8ba1e/profile-pic.png 1x,
/blog/static/bd324fda06e94524c5e91425000568d7/f937a/profile-pic.png 1.5x,
/blog/static/bd324fda06e94524c5e91425000568d7/71eb7/profile-pic.png 2x" src="/blog/static/bd324fda06e94524c5e91425000568d7/8ba1e/profile-pic.png" alt="Athul Cyriac Ajay" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p class="desc">Personal Blog of <strong style="color:hotpink">Athul Cyriac Ajay</strong> <!-- -->who is an Undergraduate Engineering Student in College of Engineering Kidangoor, a<!-- -->   <a href="https://githubcampus.expert/athul">GitHub Campus Expert</a> and a Python, Go lover.<br/>Find me on    <span><a href="https://github.com/athul" style="color:var(--link)"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>    <a href="https://twitter.com/athulcajay" style="color:var(--link)"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="skyblue" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>    <a href="https://instagram.com/athul_c_ajay" style="color:var(--link)"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="magenta" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg></a>    </span>Subscribe to the <a href="https://tinyletter.com/athul">Newsletter</a></p><div class="theme-switch-wrapper"><label class="theme-switch" style="float:right"><input type="checkbox"/><div class="slider round"></div></label></div></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/jiofi/">← <!-- -->Jiofi-CLI</a></li><li><a rel="next" href="/blog/image-gen/">Link Preview Generator in Python<!-- --> →</a></li></ul><noscript><img alt="trackingpixel" src="https://shynet-aca.herokuapp.com/ingress/fceebb68-4dce-49df-9d7e-3ecea758fc9e/pixel.gif"/></noscript> <script src="https://shynet-aca.herokuapp.com/ingress/fceebb68-4dce-49df-9d7e-3ecea758fc9e/script.js"></script></main><footer><hr/>© <!-- -->2021<!-- -->, Built by Athul with<!-- --> <a href="https://www.gatsbyjs.org" style="color:rebeccapurple">Gatsby</a>  |  <span><a href="https://blog.athulcyriac.co/rss.xml" style="color:hotpink">RSS Feed</a>    <a href="https://github.com/athul/blog" style="color:lime">Source</a></span><p style="text-decoration:bold">The Logo was designed by<!-- --> <a href="https://github.com/ForgottenTale" style="color:teal">Abhijith Kannan</a> <!-- -->a good friend of mine</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/adbot-tg/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-ae5db0200c12acc83fbc.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-a80c80a072a2dec4a792.js"],"component---src-pages-404-js":["/component---src-pages-404-js-00dee6b1e80561ef06f2.js"],"component---src-pages-index-js":["/component---src-pages-index-js-04ee3edb33808526d184.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-625262e63a34479f5aba.js"]};/*]]>*/</script><script src="/blog/webpack-runtime-d29b2035ec05bd8f2fab.js" async=""></script><script src="/blog/framework-972833c791692296cdd7.js" async=""></script><script src="/blog/app-ae5db0200c12acc83fbc.js" async=""></script><script src="/blog/styles-6b8affa5cc22cb60670e.js" async=""></script><script src="/blog/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-a13ac807210b3e33c66b.js" async=""></script><script src="/blog/cd7d5f864fc9e15ed8adef086269b0aeff617554-5e7f08b6e436d8b59f85.js" async=""></script><script src="/blog/component---src-templates-blog-post-js-625262e63a34479f5aba.js" async=""></script></body></html>