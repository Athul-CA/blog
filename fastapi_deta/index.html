<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:var(--textLink);text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}p code{font-size:1rem;}</style><meta data-react-helmet="true" property="og:image" content="https://hqasco.deta.dev/img?url=https://blog.athulcyriac.xyz/fastapi_deta/"/><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#1abaa2"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=519bd8bebf1fb294001f74588a720ed9"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=519bd8bebf1fb294001f74588a720ed9"/><title data-react-helmet="true">FastAPI + Deta = ⚡️ | dayDreams ++</title><meta data-react-helmet="true" name="description" content="Getting Started with FastAPI with Deta by creating a mailing list API"/><meta data-react-helmet="true" property="og:title" content="FastAPI + Deta = ⚡️"/><meta data-react-helmet="true" property="og:description" content="Getting Started with FastAPI with Deta by creating a mailing list API"/><meta data-react-helmet="true" property="og:type" content="website"/><meta name="generator" content="Gatsby 2.20.35"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Athul Cyriac Ajay"/><meta data-react-helmet="true" name="twitter:title" content="FastAPI + Deta = ⚡️"/><meta data-react-helmet="true" name="twitter:description" content="Getting Started with FastAPI with Deta by creating a mailing list API"/><meta data-react-helmet="true" name="twitter:image" content="https://hqasco.deta.dev/img?url=https://blog.athulcyriac.xyz/fastapi_deta/"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="theme-color" content="#f0da4f"/><style data-href="/blog/styles.b2b2f2e271d92f9b3a35.css">@import url(https://cdn.jsdelivr.net/npm/@xz/fonts@1/serve/fira-sans.min.css);@import url(https://cdn.jsdelivr.net/npm/@xz/fonts@1/serve/cascadia-code.min.css);@import url(https://fonts.googleapis.com/css2?family=Open+Sans:wght@700&display=swap);@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/blog/static/montserrat-latin-100-4124805c0503dbfe42dd67d7f5715964.woff2) format("woff2"),url(/blog/static/montserrat-latin-100-c8fb2f714bbc7bc3e8dfffa916b286dc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/blog/static/montserrat-latin-100italic-e4bf47bd171a9b2a72dd84c58bf90edf.woff2) format("woff2"),url(/blog/static/montserrat-latin-100italic-d1f3f2d02ee4d7d2d4b1ad865014f189.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/blog/static/montserrat-latin-200-444ae007121264bc1969d49b4031f9b2.woff2) format("woff2"),url(/blog/static/montserrat-latin-200-edbce16a90aa22c297a0307b85789837.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/blog/static/montserrat-latin-200italic-f316c5d1ec40f3e68654c3f38b3999f3.woff2) format("woff2"),url(/blog/static/montserrat-latin-200italic-d7bbb730d9b5e11720b3eb32326dcca7.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/blog/static/montserrat-latin-300-0a7c6df06e85d978d096d4d18fd8d43d.woff2) format("woff2"),url(/blog/static/montserrat-latin-300-5e86df2cad22d2ef2b03516334afae5e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/blog/static/montserrat-latin-300italic-c076c4892bc7a4be7b9097e97a35012d.woff2) format("woff2"),url(/blog/static/montserrat-latin-300italic-37c74a8d2d0d36a0a2c6e9a37ee15b0c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/blog/static/montserrat-latin-400-501ce09c42716a2f6e1503a25eb174c9.woff2) format("woff2"),url(/blog/static/montserrat-latin-400-f29d2b8559699b6beb5b29b25b8bc572.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/blog/static/montserrat-latin-400italic-882908d9950d9c86ebd380877f293d95.woff2) format("woff2"),url(/blog/static/montserrat-latin-400italic-22e7b04e5f2a901d49d4d342315a715a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/blog/static/montserrat-latin-500-f0f2716c5fe401d175b88715e7d28685.woff2) format("woff2"),url(/blog/static/montserrat-latin-500-991b453bf90a0980e78966d2af7e3d3a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/blog/static/montserrat-latin-500italic-4590ebba421b3288c305305d7fa7b504.woff2) format("woff2"),url(/blog/static/montserrat-latin-500italic-f3d41e4cdcc2314e49ddcea751d6f87f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/blog/static/montserrat-latin-600-15c24f7109941777774ddd2c636c6a50.woff2) format("woff2"),url(/blog/static/montserrat-latin-600-f6dc6096f48956908c1787d9a722570a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/blog/static/montserrat-latin-600italic-6d10b80529d5c36c7c09fca7193af0fc.woff2) format("woff2"),url(/blog/static/montserrat-latin-600italic-02c4833312d94b1b0866f073023a250e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/blog/static/montserrat-latin-700-79982cd1f74c6fa7451bf9b37ead09ff.woff2) format("woff2"),url(/blog/static/montserrat-latin-700-957e93fbbe131a59791cd820d98b7109.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/blog/static/montserrat-latin-700italic-283438e9577fe6a684466bb100e105ec.woff2) format("woff2"),url(/blog/static/montserrat-latin-700italic-ca627c5ccc65cf80c2ecaea44b997de9.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/blog/static/montserrat-latin-800-35386154b78d046218fc8f88a44ff515.woff2) format("woff2"),url(/blog/static/montserrat-latin-800-756655905d91b77960888262e7d58d35.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/blog/static/montserrat-latin-800italic-e1b52a7bd83e2324db6d92bdc206844c.woff2) format("woff2"),url(/blog/static/montserrat-latin-800italic-a69f0add9d86c1a84311d7dd8693ba4a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/blog/static/montserrat-latin-900-260c2ea3ef57feb82251952e605a36d5.woff2) format("woff2"),url(/blog/static/montserrat-latin-900-186cae8091da578150d81958e217714a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/blog/static/montserrat-latin-900italic-d785fb9fc74588ffb7f306799709a97d.woff2) format("woff2"),url(/blog/static/montserrat-latin-900italic-43b527fe77254f97ea36e2b54e845ec4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/blog/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/blog/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/blog/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/blog/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/blog/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/blog/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/blog/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/blog/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/blog/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/blog/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/blog/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/blog/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/blog/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/blog/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/blog/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/blog/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}body.dark{--bg:#121116;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#ff0;--textLink:#ff0;--block:hsla(0,0%,100%,0.63);--hr:hsla(0,0%,100%,0.2);--link:#121116;--date:silver;--ttr:teal;--hovercolor:#50fa7b;--headingcol:#50fa7b;background-color:var(--bg);--callout:#42b983;--calbdcol:#50fa7b;--selection:#dc143c;--gh:#1e90ff;--gh-bx:#000;--inlineCode-text:#addb67}body,body.dark{transition:background .2s ease-out}body{--bg:#fff;--textNormal:#000;--textTitle:#dc143c;--block:#928a8a;--textLink:#1e90ff;--hr:rgba(0,0,0,0.2);--link:#fff;--date:#2f4f4f;--ttr:#1e90ff;--hovercolor:navy;--headingcol:#dc143c;--callout:#0ff;--calbdcol:red;--selection:navy;--gh:#00f;--gh-bx:azure;--inlineCode-text:#e6e6e6}.theme-switch-wrapper{display:flex;align-items:center}.theme-switch{display:inline-block;height:34px;position:relative;width:60px}.theme-switch input{display:none}.slider{background-color:#000;bottom:0;cursor:pointer;left:0;right:0;top:0}.slider,.slider:before{position:absolute;transition:.4s}.slider:before{background-color:#fff;bottom:4px;content:"";height:26px;left:4px;width:26px}input:checked+.slider{background-color:#40e0d0}input:checked+.slider:before{transform:translateX(26px)}.slider.round{border-radius:34px}.slider.round:before{border-radius:50%}::selection{color:#fff;background-color:var(--selection)}.content,.desc{font-family:Fira Sans,sans-serif;font-size:large}.content a:hover{color:var(--link);background-color:var(--hovercolor)}blockquote{border-color:#639;color:var(--textNormal)}hr{border-top:3px solid #639}.gatsby-highlight{font-size:smaller;position:relative}.gatsby-highlight pre[class*=language-]{-webkit-overflow-scrolling:touch}.gatsby-highlight pre[class*=language-]:before{background:#000;border-radius:0 0 .25rem .25rem;color:#fff;font-size:12px;letter-spacing:.025rem;padding:.1rem .5rem;position:absolute;right:1rem;text-align:right;text-transform:uppercase;top:0}.gatsby-highlight pre[class=language-js]:before{content:"js";background:#f7df1e;color:#000}.gatsby-highlight pre[class*=language-yaml]:before,.gatsby-highlight pre[class*=language-yml]:before{content:"yaml";background:#f71e6a;color:#fff}.gatsby-highlight pre[class*=language-bash]:before,.gatsby-highlight pre[class*=language-sh]:before,.gatsby-highlight pre[class*=language-shell]:before{content:"shell";background:green;color:#fff}.gatsby-highlight pre[class*=language-json]:before{content:"json";background:#eee8aa;color:#000}.gatsby-highlight pre[class*=language-py]:before,.gatsby-highlight pre[class*=language-python]:before{content:"py";background:#00f;color:#ff0}.gatsby-highlight pre[class*=language-jsx]:before{content:"jsx";background:#f0f;color:#fff}.gatsby-highlight pre[class*=language-html]:before{content:"html";background:#ff4500;color:#fff}.gatsby-highlight pre[class*=language-css]:before{content:"css";background:#0ff;color:#000}.gatsby-highlight pre[class*=language-go]:before{content:"Go";background:#0ff;color:#4169e1}.gatsby-highlight pre[class*=language-md]:before{content:"md / MDX";background:#4169e1;color:#f5f5f5}.gatsby-highlight pre[class*=language-diff]:before{content:"DIFF";background:#32cd32;color:red}.bio{font-family:Fira Sans,sans-serif;font-size:medium}img{display:block;margin:0 auto}h2,h3,h4,h5{letter-spacing:-.015em;font-family:Open Sans,sans-serif;font-size:x-large}.callout{color:#000;background:azure;padding:1.5em 1.25em;border-radius:25px;display:flex;flex-direction:row;margin-top:20px;border-bottom:4px solid var(--calbdcol);border-left:6px solid var(--calbdcol)}.callout-inner{font-style:italic;margin-left:1em}.callout a{color:#00f}.callout a:hover{background:#adff2f}@media (max-width:767px){.callout{padding:1.5em .75em 1.5em .6em}.callout-inner{margin-left:.5em}}div .callout:before{color:red;content:attr(emoji)}.new-label{color:#50fa7b;text-decoration:none;padding:2px 4px;border-radius:4px;margin-left:6px;background-color:#1e90ff}code[class*=language-],pre[class*=language-]{color:#fff;background:none;font-family:Cascadia Code,monospace;font-feature-settings:normal;font-size:medium;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:hsla(0,0%,100%,.15)}:not(pre)>code[class*=language-]{border-radius:.3em;background:#031627;color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;display:block;padding-right:1em;padding-left:1.25em;border-left:.25em solid #ffa7c4}.gatsby-highlight,.gatsby-highlight-code-line{margin-right:-1.3125rem;margin-left:-1.3125rem}.gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}</style><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-625262e63a34479f5aba.js"/><link as="script" rel="preload" href="/blog/cd7d5f864fc9e15ed8adef086269b0aeff617554-5e7f08b6e436d8b59f85.js"/><link as="script" rel="preload" href="/blog/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-a13ac807210b3e33c66b.js"/><link as="script" rel="preload" href="/blog/styles-6b8affa5cc22cb60670e.js"/><link as="script" rel="preload" href="/blog/app-ae5db0200c12acc83fbc.js"/><link as="script" rel="preload" href="/blog/framework-972833c791692296cdd7.js"/><link as="script" rel="preload" href="/blog/webpack-runtime-d29b2035ec05bd8f2fab.js"/><link as="fetch" rel="preload" href="/blog/page-data/fastapi_deta/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="background-color:var(--bg);color:var(--textNormal);transition:color 0.2s ease-out, background 0.2s ease-out;margin-left:auto;margin-right:auto;max-width:61.25rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:tomato" href="/blog/">dayDreams ++</a></h3></header><main><h1 align="center" style="color:lightseagreen">FastAPI + Deta = ⚡️</h1><p align="center" style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem">July 07, 2020<br/></p><div class="content"><p><a href="https://fastapi.tiangolo.com/">FastAPI</a> is a a Python Framework for building RESTful APIs. It has all the simplicity of Python with a added advantages of Async⚡️, automatic Schema Generation and OpenAPI and Python Types✨(with Pydantic). FastAPI is relatively a new Project and is gaining quite a good traction in the Dev world. It has got nearly <a href="https://github.com/tiangolo/fastapi">16k stars on GitHub</a> and about 160 contributors. The main plus side of FastAPI is the documentation which is <strong>Top Notch</strong>.</p><p><a href="https://deta.sh">Deta</a> is a company that is building a cloud platform which is developer friendly and to reduce the hassle from idea to app.</p><blockquote><p><em>“Deta is building a cloud for the developers with less build “bells and whistles”, only what’s needed to get the job done – a Micro Cloud.”</em></p></blockquote><p>Personally what attracted me to deta was the ease to implement. I was having a hard time to connect FastAPI with SQLalchemy since I am a noob. Then Deta entered or at least then I came to know about it.</p><p>I was skeptical at first, but the simplicity of working with Deta amazed me and their Slack community is ✨. The creators are almost active everytime and they will help you in anyway possible to overcome an issue.</p><h2>What we’ll build</h2><p>We’re going to build a Personal <strong>Mailing List</strong> API with </p><ul><li>FastAPI for the API and Logic</li><li>Deta.sh as our DB</li><li>Deploy it on Deta Micros</li></ul><p>We’re only going to build the API, you can use <a href="https://www.mailgun.com/">Mailgun</a> or <a href="https://sendgrid.com/">SendGrid</a> to send the emails. Our API will consist of 4 Operations.</p><ul><li>Add a new Person to our List</li><li>Get all the emails from our list</li><li>Update the email of a specific user in our List</li><li>Delete a Subscriber/User from our List</li></ul><h2>Setting up FastAPI and Deta</h2><p>Hope you have Python 3.6+ interpreter on your machine. If you don’t make sure to download it and install and verify by running python in your terminal</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ python3
Python <span class="token number">3.7</span>.6 <span class="token punctuation">(</span>default, Dec <span class="token number">30</span> <span class="token number">2019</span>, <span class="token number">19</span>:38:26<span class="token punctuation">)</span>
<span class="token punctuation">[</span>Clang <span class="token number">11.0</span>.0 <span class="token punctuation">(</span>clang-1100.0.33.16<span class="token punctuation">)</span><span class="token punctuation">]</span> on darwin
Type <span class="token string">&quot;help&quot;</span>, <span class="token string">&quot;copyright&quot;</span>, <span class="token string">&quot;credits&quot;</span> or <span class="token string">&quot;license&quot;</span> <span class="token keyword">for</span> <span class="token function">more</span> information.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span></code></pre></div><p>The above output is on my machine and it will change from machine to machine.</p><p>Next thing is to have a folder and a virtual environment, for that we could use either Pipenv or venv. <a href="https://pipenv-fork.readthedocs.io/en/latest/">Pipenv</a> is a package for handling and managing Python envs automatically, you can install pipenv with,</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ pip <span class="token function">install</span> --user pipenv</code></pre></div><p>Once we installed Pipenv to set up our environment follow the commands to install</p><ul><li>FastAPI</li><li>Uvicorn - The ASGI Server</li><li>Deta - Python Wrapper for the Deta Bases</li></ul><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">mkdir</span> mailing-list
$ <span class="token builtin class-name">cd</span> mailing-list
$ pipenv shell <span class="token comment">#it will make the virtual environment</span>
$ pipenv <span class="token function">install</span> fastapi uvicorn deta</code></pre></div><p>If we’re using venv, then for creating a venv and installing the packages, follow</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">mkdir</span> mailing-list
$ <span class="token builtin class-name">cd</span> mailing-list
$ python3 -m venv venv
$ <span class="token builtin class-name">source</span> venv/bin/activate
$ pip <span class="token function">install</span> fastapi uvicorn deta</code></pre></div><p>These are for Unix like systems and on Windows to activate a Virtualenv follow,</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">venv<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>activate
</code></pre></div><p>Once we have set up our Dev Environment. Let’s move on to building the Mailing List.</p><p>For Deta, create an Account in Deta and create a new Project and get the Project Key. Save the Project key since it will be shown once. You can save it as an environment variable by executing the below code in Unix like(Linux/Mac).</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">export</span> DETA_PROJECT_KEY <span class="token operator">=</span> <span class="token operator">&lt;</span>project key<span class="token operator">&gt;</span></code></pre></div><p>and on Windows, use</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">set DETA_PROJECT_KEY = &lt;project key&gt;</code></pre></div><p>We’ll also save the key in a <code class="language-text">.env</code> file. This env file s important for the deployment process. For that we need to create a file called <code class="language-text">.env</code> and save the Project Key like</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">DETA_PROJECT_KEY = &lt;project key&gt;</code></pre></div><p>That’s it. Lets move on to the code</p><hr/><h2>The Code</h2><p>Let’s start by making a simple REST API endpoint with FastAPI on a file called <code class="language-text">main.py</code></p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token comment"># main.py</span>
<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello World&quot;</span></code></pre></div><p>This is just a hello world app with FastAPI and for running this, we’ll need uvicorn. Execute the following in the terminal/cmd,</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ uvicorn main:app --reload
INFO:     Uvicorn running on http://127.0.0.1:8000 <span class="token punctuation">(</span>Press CTRL+C to quit<span class="token punctuation">)</span>
INFO:     Started reloader process <span class="token punctuation">[</span><span class="token number">13050</span><span class="token punctuation">]</span> using statreload
INFO:     Started server process <span class="token punctuation">[</span><span class="token number">13052</span><span class="token punctuation">]</span>
INFO:     Waiting <span class="token keyword">for</span> application startup.
INFO:     Application startup complete.</code></pre></div><p>Our API will be actve the port <code class="language-text">8000</code>. FastAPI has inbuilt support for OpenAPI, Swagger and Redoc. To view the docs for our App, just go to <a href="localhost:8000/docs">localhost:8000/docs</a>. To check if our endpoint works, just execute</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> http://127.0.0.1:8000/
<span class="token string">&quot;Hello World&quot;</span></code></pre></div><p>So now, let’s move on to our main parts</p><h2>New Subscriber</h2><p>We’ll be using the <a href="https://docs.deta.sh/docs/base/lib/">docs</a> by Deta for all references.</p><p>We need to create a new endpoint for a someone to subscribe to our Mailing List. So we’ll just need the Person’s Name and Email to be in our DB. </p><blockquote><p>Take care that in some countries its illegal to send emails to people without consent. We’ll make a delete endpoint for them to delete themselves from the list</p></blockquote><p>Let’s get on to the code for adding a new subscriber to our list. The Python code without the use of a DB or simply the code with FastAPI. </p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token comment"># main.py</span>

<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token punctuation">,</span> NameEmail

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    full_name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    email<span class="token punctuation">:</span> NameEmail

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribe&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">newUser</span><span class="token punctuation">(</span>sub<span class="token punctuation">:</span> Subscriber<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> sub<span class="token punctuation">.</span>full_name
    email <span class="token operator">=</span> sub<span class="token punctuation">.</span>email

    <span class="token comment"># you could also return sub.json() or sub.dict()</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;full_name&quot;</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span>
        <span class="token string">&quot;email&quot;</span><span class="token punctuation">:</span> email
    <span class="token punctuation">}</span></code></pre></div><p>We’re using Pydantic <code class="language-text">BaseModel</code> class to <em>inherit</em> our <code class="language-text">Subscriber</code> class. Then we make the subscriber class a dict to fetch data from the request’s body. <code class="language-text">NameEmail</code> will help us get the name part of the email.</p><blockquote><p>The output is a NameEmail object which has two properties: name and email. For <a href="mailto:fred.bloggs@example.com">fred.bloggs@example.com</a>, name property would be “fred.bloggs”.</p></blockquote><div class="callout" emoji="🛑"><div class="callout-inner">Since we&#x27;re using <u><b>NameEmail</b></u> we&#x27;ll need to install `email-validator` to work with it. Just run `pip install pydantic[email-validator]`</div></div><br/><p>This snippet will return the things that we have provided to it. I have entered the data by going to  <a href="http://127.0.0.1:8000/docs">localhost:8000/docs</a> if you have your server running. Our Output if we provide <code class="language-text">athul</code> for name and <code class="language-text">athul@example.com</code> for email will be</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;athul&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;athul@example.com&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div><p>Now let’s connect it with the database, Deta Base in this case. We’ll be using Python’s <code class="language-text">os</code> package to get the Project Key. We have save the project key to the env vars and restart the server for it to work.</p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token comment"># main.py</span>

<span class="token keyword">import</span> os
<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token punctuation">,</span> NameEmail
<span class="token keyword">from</span> deta <span class="token keyword">import</span> Deta

deta <span class="token operator">=</span> Deta<span class="token punctuation">(</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">&quot;DETA_PROJECT_KEY&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
db <span class="token operator">=</span> deta<span class="token punctuation">.</span>Base<span class="token punctuation">(</span><span class="token string">&quot;mydb&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># this can be anything related to your use case</span>

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    full_name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    email<span class="token punctuation">:</span> NameEmail

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribe&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">newUser</span><span class="token punctuation">(</span>sub<span class="token punctuation">:</span>Subscriber<span class="token punctuation">)</span><span class="token punctuation">:</span>
    subscriber <span class="token operator">=</span> db<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;full_name&quot;</span><span class="token punctuation">:</span> sub<span class="token punctuation">.</span>full_name<span class="token punctuation">,</span>
        <span class="token string">&quot;email&quot;</span><span class="token punctuation">:</span> sub<span class="token punctuation">.</span>email<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span><span class="token punctuation">:</span> sub<span class="token punctuation">.</span>email<span class="token punctuation">.</span>name
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> subscriber</code></pre></div><p>Here we have imported the deta library and initialized it with a db name. We’re specifying a key for the data. This key will be the name part of the email since most times it will be unique. If we don’t specify a key, deta will generate a unique key for the record.</p><div class="callout" emoji="🎁"><div class="callout-inner">You can have multiple DBs with a single project key</div></div><br/><p>We’re using Deta’s <code class="language-text">PUT</code> method(/function) to insert our data into our DetaBase. The PUT method will generate a <strong>unique key</strong> for our data and will be stored if we don’t specify a key. The output if we add ourselves a new subscriber with provide <code class="language-text">John Doe</code> for name and <code class="language-text">john@example.com</code> for email will be,</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john@example.com&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span>
<span class="token punctuation">}</span></code></pre></div><p>So we have made an endpoint for people to subscribe to our Mailing List 🎉.<br/>
<!-- -->Next we’ll make an endpoint for people to update a theirs info like their Name or Email.</p><h2>Update a Subscriber</h2><p>We’ll create a new <code class="language-text">UpdateSubscriber</code> class for updating a Subscriber’s Name or Email. We’ll use the <code class="language-text">get</code> and <code class="language-text">update</code> methods of deta to fetch and update the data. We’ll also raise an error if the record is not found in the base</p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token comment"># main.py</span>

<span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional
<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> NameEmail<span class="token punctuation">,</span>HTTPException

<span class="token keyword">class</span> <span class="token class-name">UpdateSub</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    full_name<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    email<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>NameEmail<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>patch</span><span class="token punctuation">(</span><span class="token string">&quot;/subscriber/{email}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_sub</span><span class="token punctuation">(</span>upsub<span class="token punctuation">:</span> UpdateSub<span class="token punctuation">,</span> email<span class="token punctuation">:</span> NameEmail<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sub <span class="token operator">=</span> db<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token keyword">if</span> sub <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> HTTPException<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span><span class="token string">&quot;User Not Subscribed&quot;</span><span class="token punctuation">)</span>

    updates <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> upsub<span class="token punctuation">.</span>full_name<span class="token punctuation">:</span>
        updates<span class="token punctuation">[</span><span class="token string">&quot;full_name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> upsub<span class="token punctuation">.</span>full_name

    <span class="token keyword">if</span> upsub<span class="token punctuation">.</span>email<span class="token punctuation">:</span>
        updates<span class="token punctuation">[</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> upsub<span class="token punctuation">.</span>email<span class="token punctuation">.</span>email

    db<span class="token punctuation">.</span>update<span class="token punctuation">(</span>updates<span class="token punctuation">,</span> key<span class="token operator">=</span>sub<span class="token punctuation">[</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;User Updated&quot;</span><span class="token punctuation">}</span></code></pre></div><p>This endpoint will update the email or full_name of a subscriber but the caveat here is that the key cannot be changed even if the email is changed. Let’s make a new user with the name John Reese(Person of Interest) with an initial email <code class="language-text">reese@gmail.com</code>. Now let’s update his email using this endpoint, for that our request URL will be as follows,</p><p><code class="language-text">http://localhost:8080/subscriber/reese%40example.com</code> You can see that after the <code class="language-text">/subscriber</code> in the url, we are passing the original email and this is called a <strong>Path Parameter</strong>. We use the path paramter and get the name part of it and use it as the Key. For updating the email, we take the new email and update it in our Deta base with the update command. The updates should be in the form of a Python <code class="language-text">dict</code>. If the operation done is correct, then we’ll get a <code class="language-text">None</code> type in return</p><h2>Get all Subscribers</h2><p>This endpoint will send a <code class="language-text">GET</code> HTTP method for fetching all the data from our Deta-Base. We’ll use the <code class="language-text">fetch</code> function/method of deta to retreive all the data from our base. The <code class="language-text">fetch</code> function will return a <a href="https://www.programiz.com/python-programming/generator">generator</a> type, so we’ll be using the <code class="language-text">next()</code> function to get all the data as a <code class="language-text">List</code>. The endpoint will be like</p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribers&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_all_subs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;subscribers&quot;</span><span class="token punctuation">:</span> <span class="token builtin">next</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></code></pre></div><p>The output of the above request will be</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;subscribers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;athul@example.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;athul&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Athuk&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john@example.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jhreese@gmail.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Reese&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reese&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div><p>Now we have setup a Create, Update and Read endpoints. Next we’ll look into the Delete operation.</p><h2>Delete Subscribers</h2><p>To delete a subscriber, we’ll take in the <code class="language-text">full_name</code> as the input to find the subscriber and if we there is more than one record with the same full_name, we’ll fetch the data with email. Then we’ll use the <code class="language-text">delete</code> method to delete the record by getting the key from our records. </p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token comment"># main.py</span>

<span class="token keyword">class</span> <span class="token class-name">DelSub</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>NameEmail<span class="token punctuation">]</span>
    full_name<span class="token punctuation">:</span> <span class="token builtin">str</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>delete</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribers.del&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">unsubscribe</span><span class="token punctuation">(</span>unsub<span class="token punctuation">:</span> DelSub<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> delsub<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;full_name&#x27;</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;email&#x27;</span><span class="token punctuation">)</span>
    sub <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;full_name&#x27;</span><span class="token punctuation">:</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        sub <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;email&#x27;</span><span class="token punctuation">:</span>email<span class="token punctuation">.</span>email<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> HTTPException<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">&quot;email not found&quot;</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>sub<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;key&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;Record Deleted&quot;</span><span class="token punctuation">}</span></code></pre></div><p>The response if a record is deleted will be a Python <code class="language-text">None</code> type so we respond with a message,</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;Record Deleted&quot;</span><span class="token punctuation">}</span></code></pre></div><p>So we have made a CRUD API for a personal mailing list. Now let’s deploy it.</p><h2>Deploy our API</h2><p>For Deploying our API, we’ll need Deta Micros.</p><blockquote><p>Deta Micros(ervers) are a leightweight but scalable cloud runtime tied to an HTTP endpoint. They are meant to get your apps up and running blazingly fast. Focus on writing your code and Deta will take care of everything else.</p></blockquote><p>You need to have Deta Micros’ CLI installed in your system. You can install by following the instructions in this <a href="https://docs.deta.sh/docs/micros/getting_started">link</a>. Once you’ve installed, we need to login to Deta via the CLI, for that execute the following command</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">deta login</code></pre></div><p>It’ll open a new browser window and will authenticate the CLI. Next we need to start a new micro. We’ll also need a <code class="language-text">requirements.txt</code> for managing our dependencies, for that either you can copy the response for the command <code class="language-text">pip freeze</code> and paste it in a file called <code class="language-text">requirements.txt</code> or on <em>*<!-- -->nix</em> systems, you can just execute</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">pip freeze <span class="token operator">&gt;</span> requirements.txt</code></pre></div><p>This will paste the output of <code class="language-text">pip freeze</code> to <code class="language-text">requirements.txt</code>. Once we have done we need to deploy it to deta using the command. Once we’ve done this let’s create a new micro, for that we can use the <code class="language-text">deta new</code> command</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ deta new
<span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mailing-list&quot;</span>,
        <span class="token string">&quot;runtime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;python3.7&quot;</span>,
        <span class="token string">&quot;endpoint&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&lt;url&gt;&quot;</span>,
        <span class="token string">&quot;visor&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;enabled&quot;</span>,
        <span class="token string">&quot;http_auth&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;enabled&quot;</span>
<span class="token punctuation">}</span></code></pre></div><p>It will automatically detect that we’ll need a Python runtime and will deploy our code and give us a unique link for our Micro.</p><p>Yay we have deployed the API, for the details of the micro, just execute the following for details of the micro.</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ deta details
<span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mailing-list&quot;</span>,
        <span class="token string">&quot;runtime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;python3.7&quot;</span>,
        <span class="token string">&quot;endpoint&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&lt;url&gt;&quot;</span>,
        <span class="token string">&quot;visor&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;enabled&quot;</span>,
        <span class="token string">&quot;http_auth&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;enabled&quot;</span>
<span class="token punctuation">}</span></code></pre></div><p>We need to update the environment variable to set our project_key, execute the <code class="language-text">deta update</code> command like this</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ deta update -e .env
Updating environment variables<span class="token punctuation">..</span>.
Successfully updated micro&#x27;s environment variables
</code></pre></div><p>You can disable authentication for the API to be publically available, just execute <code class="language-text">deta auth disable</code>.</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ deta auth disable
Successfully disabled http auth</code></pre></div><p>If we go to our Micro’s url we’ll see a <code class="language-text">Hello World</code> response which we wrote as the <code class="language-text">/</code> endpoint. We can see the OpenAPI spec and the Swagger Documentation, if we go to the <code class="language-text">/docs</code> url, we’ll see a page like this</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px">
      <a class="gatsby-resp-image-link" href="/blog/static/42e994e027cf6429c9028116ccce12e3/a6ec4/fastapi.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:55.333333333333336%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABAElEQVQoz6WS3U7EIBCFef/38MLog2xi9s7E+LtGu4VC3RbKT2mhx2ET71sL+TITMnNyBmCXTqPmEmdeo3cCKSXMaSbSNV/LXz3rtUcjLvDeIy8T9i7Wmh/UmpwtCXEmZ7mQNjOVPpqMHeoKN0+PeJMSJ9XiPBjIQK6924QgunEEO/Ye97XGa9PinRfRC2rjoMYIFVZCtZKijuRQHB/wfHcLcfpE81VBflfoRQPbthjIsV3JIBWC1mAfTcThxUN2Hr2NMD5hCIW8idLnYwYLISDEgIV2znkX128TwgilFKxzcDuZpgksxgjOOYQQMMbsFxzpqYugpgsth9baf1MEfwFGkVIKLdZm+wAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="FastAPI Docs" title="FastAPI Docs" src="/blog/static/42e994e027cf6429c9028116ccce12e3/c1b63/fastapi.png" srcSet="/blog/static/42e994e027cf6429c9028116ccce12e3/5a46d/fastapi.png 300w,/blog/static/42e994e027cf6429c9028116ccce12e3/0a47e/fastapi.png 600w,/blog/static/42e994e027cf6429c9028116ccce12e3/c1b63/fastapi.png 1200w,/blog/static/42e994e027cf6429c9028116ccce12e3/a6ec4/fastapi.png 1438w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><hr/><p>Yay we have created an API with FastAPI and Deta and Deployed it to the Web.</p><p><img src="/blog/e0d7926a3371dfd5fb97833f50c6ecab/yay.gif" alt="Yay Gif"/></p><p>That leads to the end of this post, here is the whole source code</p><div class="gatsby-highlight" data-language="py"><pre class="language-py"><code class="language-py"><span class="token keyword">import</span> os
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional
<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI<span class="token punctuation">,</span> HTTPException
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token punctuation">,</span> NameEmail
<span class="token keyword">from</span> deta <span class="token keyword">import</span> Deta

deta <span class="token operator">=</span> Deta<span class="token punctuation">(</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">&quot;DETA_PROJECT_KEY&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
db <span class="token operator">=</span> deta<span class="token punctuation">.</span>Base<span class="token punctuation">(</span><span class="token string">&#x27;mailing-list&#x27;</span><span class="token punctuation">)</span>

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    full_name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    email<span class="token punctuation">:</span> NameEmail

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribe&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">newUser</span><span class="token punctuation">(</span>sub<span class="token punctuation">:</span>Subscriber<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> sub<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;full_name&quot;</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span>
    subscriber<span class="token operator">=</span> db<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;full_name&quot;</span><span class="token punctuation">:</span>name<span class="token punctuation">,</span>
        <span class="token string">&quot;email&quot;</span><span class="token punctuation">:</span>email<span class="token punctuation">.</span>email
    <span class="token punctuation">}</span><span class="token punctuation">,</span>key<span class="token operator">=</span>email<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> subscriber

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribers&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">getAllSubs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;subscribers&quot;</span><span class="token punctuation">:</span><span class="token builtin">next</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">UpdateSub</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    full_name<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    email<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>NameEmail<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>patch</span><span class="token punctuation">(</span><span class="token string">&quot;/subscriber/{email}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">updateSub</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">:</span>UpdateSub<span class="token punctuation">,</span>email<span class="token punctuation">:</span>NameEmail<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> subscriber<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    new_name <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;full_name&quot;</span><span class="token punctuation">)</span>
    new_email <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span>
    sub <span class="token operator">=</span> db<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token keyword">if</span> sub <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> HTTPException<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">&quot;User Not Subscribed&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> new_email <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        update <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;full_name&quot;</span><span class="token punctuation">:</span>new_name<span class="token punctuation">}</span>
    <span class="token keyword">if</span> new_name <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        update <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">:</span>new_email<span class="token punctuation">.</span>email<span class="token punctuation">}</span>
    db<span class="token punctuation">.</span>update<span class="token punctuation">(</span>updates<span class="token operator">=</span>update<span class="token punctuation">,</span>key<span class="token operator">=</span>sub<span class="token punctuation">[</span><span class="token string">&#x27;key&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;User Updated&quot;</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">DelSub</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email<span class="token punctuation">:</span>Optional<span class="token punctuation">[</span>NameEmail<span class="token punctuation">]</span>
    full_name<span class="token punctuation">:</span><span class="token builtin">str</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>delete</span><span class="token punctuation">(</span><span class="token string">&quot;/subscribers.del&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">deleteSub</span><span class="token punctuation">(</span>delsub<span class="token punctuation">:</span>DelSub<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data<span class="token operator">=</span>delsub<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;full_name&#x27;</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;email&#x27;</span><span class="token punctuation">)</span>
    sub <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;full_name&#x27;</span><span class="token punctuation">:</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        sub <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;email&#x27;</span><span class="token punctuation">:</span>email<span class="token punctuation">.</span>email<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> HTTPException<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">&quot;email not found&quot;</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>sub<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;key&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;Record Deleted&quot;</span><span class="token punctuation">}</span> 

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello World&quot;</span></code></pre></div><h2>Conclusion</h2><p>This is just a demo for getting started with FastAPI with Deta.sh. You can change the key for your preference or use the key generated automatically by Deta. You can also use the email address as your key but you may need to switch the <code class="language-text">@</code> character with something else like a <code class="language-text">-</code> or <code class="language-text">_</code> for its place. If you have any queries or doubts or feedback, you can use the comments section for the same and do let me if this has helped you. Go forth and build awesome stuff ⚡️. Thank You ❤️</p></div><div id="inject-comments-for-uterances"></div><hr style="margin-bottom:1.75rem"/><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAFqElEQVQ4yz2Va0yTZxTHX3UbKggiCkWYGBQRtVRARZ2dDuccoigyB+h0jjCHIigirBah7duWUmwpvdEWSu83oFCM6Axh1+wSF7Pbh23ZhyXbPuzbPixbFqE9/72UuZM8OU9Ozvk9/+eS8zA+zW1mwTx9nUygv2sp859NW5XHIybW0dNy4YcReds/4/puhPXdf0yZ2E+nTHLp1KBy29Ncn6Z72YL3a6WLAa9KxLi0oiULc3ffu2VBbedjm+wGGmtPYmvuJuzi83HqSBm9XVPNxarQcr4aVlnb3KRZYb/TeTVtoS6gk8WhzHjIyCgYZsmiSrE4bGLjBRt4vGhqcuo8b11mLD0tgzZu2Iyt+YW0JW9HNC01fS73+SxY5e0YN7C/TRjkJXGFC9Dh05XxbXp13V1T1h4EB6T08t6i+dXJqRxkE+3cUUxF/BIqKBBgS952EvBLsCE7hxhmGfHztz4ZVnXDphD/6e9nC58eAWPeWXws2COCXy+LhQZkMdXNy7hyZC9V7xZQTnYu1q3lYXNmJgqy1yM1OQXpazMoMyOLkhKTUXG0Yk59uxN+Hfv9hIldzoQZ5llLzpbvR5UiBI2K6KRVDaeyg76SN9C91jpcEJagbq8AyuoyvHWoFNlZOcjP24ZMXjYlPLeCXhK+DI1U9uTusAYBfU8XM5TEq3XmbYdP0zU/alaSSdJG75yqoPaKA2h+9QDaak5gsLEWH4vfxOVDJUhKWo2MdTzw0rOQmpJGZQePkEbGxsbMavgNql8YexJvzJvPh1cnnR+19JK6tZFEr1Ug0HQeuroKtFYeRU2pAOIKIWSVQuRlrcdzy5OQuHIVVq5IxOkTVTSgkFHIqIK7n51j3Dcaf/F1XOWAspjPoCBvvwSfdV/Cj4preNBSi0edDXjUVY+H105BdXI/cjPSUZDFw5qkZKStWQsje4v8RhVx6mBXS2KM2yCLekwKji4lt05GYwYWt469gEt7+JAdF8JXfwKzra/jC3EtHPXlaHpxJ4I1Zagv2oqDB/ZjckgLZz8Ln15JFqUY3IOWRN06Ftwgn1FJdnUn5Oeq8NjMQnf2BK4dLIbxjBADdWWoLN4GW+1hfNJ0GlWFWyAXtWLMosWIRgGvvof0sg4wDh37q9ugxEg/BzT1kkV1G/Lqcsy2v43ZW+/A01CJ64dLcKggF9vW8+A59wou7+OjtEiAgKkPTp2KHFolJ6YPms42YkZ0irDP3AeLunveya3S2XyJ6g/uhvi1crx+YA+qdu1Aae7zWJ2YiN05mWgXbsfe/E3olUjgMupg71fRUJ+MPPpesDeb5xinvvesh1vJMzgw/2A8TA6TjXYJiumZZc9gRcIKpCatQmJCQnxUC/LQ/iIfl2vOIODwYcg4QpP+CI06vbGgzcwBr/7GXL9wKMFvNf344fQMHkYeRsfdQVi1erpYW0drU1KwavlyZKaswu6N69EiLEQrdyk6iRQT/nFyWd0UCU3j/uTsk0cfPUbEF1xsNzOR+ycfjN/FpD8cs+vNsTtSFpNuNzWeqaIiXipOFW5GEweTlO2A9Ew5lzdGLouDHBYnwr7Judl7H3BiZn76+tGvK5kRozneHIIOD/teeBqDGl3M3Kedn+CANnUP1ZQUUJuwgNgjfLCV+yloNtODiXs02G+mgCv0ZDp8n4NO/D1ssBbF1YU9AeZO12KT9Q25pC6zDR7LMG61NEdvNLw1rxZ1xC7s49ObRRshutRAbY2NUdHVljmn1YmHd2cQcod+t5vtpQv1kUBksSf6h13MN59/G587jNZyQ6/2O7m4C4NqDazqHpx9aR+uVBwmyc0OdN9og06lhXfER2OeMZ/TNJyxUDfqGl2EBezuuLfpDMy4OxTf/hu1F5cODZirgg4f97y0P0tbr0dvNzdBwyr+sptsXzqsrp5IKCL4/wsY9sZhM1PvM/8CwPAjF+wgjHMAAAAASUVORK5CYII=" alt="Athul Cyriac Ajay" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/blog/static/bd324fda06e94524c5e91425000568d7/8ba1e/profile-pic.png 1x,
/blog/static/bd324fda06e94524c5e91425000568d7/f937a/profile-pic.png 1.5x,
/blog/static/bd324fda06e94524c5e91425000568d7/71eb7/profile-pic.png 2x" /><img loading="lazy" width="50" height="50" srcset="/blog/static/bd324fda06e94524c5e91425000568d7/8ba1e/profile-pic.png 1x,
/blog/static/bd324fda06e94524c5e91425000568d7/f937a/profile-pic.png 1.5x,
/blog/static/bd324fda06e94524c5e91425000568d7/71eb7/profile-pic.png 2x" src="/blog/static/bd324fda06e94524c5e91425000568d7/8ba1e/profile-pic.png" alt="Athul Cyriac Ajay" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p class="desc">Personal Blog of <strong style="color:hotpink">Athul Cyriac Ajay</strong> <!-- -->who is an Undergraduate Engineering Student in College of Engineering Kidangoor, a<!-- -->   <a href="https://githubcampus.expert/athul">GitHub Campus Expert</a> and a Python, Go lover.<br/>Find me on    <span><a href="https://github.com/athul" style="color:var(--link)"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>    <a href="https://twitter.com/athulcajay" style="color:var(--link)"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="skyblue" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>    <a href="https://instagram.com/athul_c_ajay" style="color:var(--link)"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="magenta" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg></a>    </span>Subscribe to the <a href="https://tinyletter.com/athul">Newsletter</a></p><div class="theme-switch-wrapper"><label class="theme-switch" style="float:right"><input type="checkbox"/><div class="slider round"></div></label></div></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/hack/">← <!-- -->Hacking the Quarantine</a></li><li><a rel="next" href="/blog/readme_ghactions/">Updating GitHub Readme with Waka-readme<!-- --> →</a></li></ul><noscript><img alt="trackingpixel" src="https://shynet-aca.herokuapp.com/ingress/fceebb68-4dce-49df-9d7e-3ecea758fc9e/pixel.gif"/></noscript> <script src="https://shynet-aca.herokuapp.com/ingress/fceebb68-4dce-49df-9d7e-3ecea758fc9e/script.js"></script></main><footer><hr/>© <!-- -->2021<!-- -->, Built by Athul with<!-- --> <a href="https://www.gatsbyjs.org" style="color:rebeccapurple">Gatsby</a>  |  <span><a href="https://blog.athulcyriac.co/rss.xml" style="color:hotpink">RSS Feed</a>    <a href="https://github.com/athul/blog" style="color:lime">Source</a></span><p style="text-decoration:bold">The Logo was designed by<!-- --> <a href="https://github.com/ForgottenTale" style="color:teal">Abhijith Kannan</a> <!-- -->a good friend of mine</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/fastapi_deta/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-ae5db0200c12acc83fbc.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-a80c80a072a2dec4a792.js"],"component---src-pages-404-js":["/component---src-pages-404-js-00dee6b1e80561ef06f2.js"],"component---src-pages-index-js":["/component---src-pages-index-js-04ee3edb33808526d184.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-625262e63a34479f5aba.js"]};/*]]>*/</script><script src="/blog/webpack-runtime-d29b2035ec05bd8f2fab.js" async=""></script><script src="/blog/framework-972833c791692296cdd7.js" async=""></script><script src="/blog/app-ae5db0200c12acc83fbc.js" async=""></script><script src="/blog/styles-6b8affa5cc22cb60670e.js" async=""></script><script src="/blog/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-a13ac807210b3e33c66b.js" async=""></script><script src="/blog/cd7d5f864fc9e15ed8adef086269b0aeff617554-5e7f08b6e436d8b59f85.js" async=""></script><script src="/blog/component---src-templates-blog-post-js-625262e63a34479f5aba.js" async=""></script></body></html>